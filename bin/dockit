#!/bin/sh

while getopts "d:"  opt
do
    case $opt in
        d)
            detach=true
            shift
    esac
done

img=$1
docker pull $img 1>&2

scriptdir="$(dirname "$0")"
lib="$(cd $scriptdir/../lib ; pwd)/dockit"

docker run \
    --rm \
    --privileged \
    -ti \
    ${detach:+-d} \
    -v $lib/init:/dockit-init \
    -v $lib/undock:/bin/undock \
    -v $(pwd):/host \
    $img \
    /dockit-init
